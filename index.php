<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
       "http://www.w3.org/TR/html40/loose.dtd">
<HTML>
<HEAD>
<?php

  $htmlmeta[] = "HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=iso-8859-1\"";
  if (is_array($htmlmeta))
    while (list(,$value) = each($htmlmeta))
      echo "<META $value>\n";

?>
<title>Friheden til at vælge</title>
</HEAD>


<body>
<?php
   // $Id$
   // Første version af Hans Schou. Dernæst har Peter og Hans rettet i et væk.

   /* top.phtml sets 
      <!--DOCTYPE ....
      .....
      ... [topmenu] ...
   */
   $htmltitle_en="Liberty of writing books";
   $htmltitle_da="Friheden til at skrive bøger";
   $htmltitle_sv="Friheden til at skrive böcker";
   $bodyarg=" background=\"/grafix/linux-back-1.gif\" ";
   $maintain_name = "Hans Schou";       // Skriv dit navn her
   $maintain_email = "chlor@sslug.dk";  // Skriv din email adresse her
   if (file_exists($DOCUMENT_ROOT."includes/top.phtml")) {
     include($DOCUMENT_ROOT."includes/top.phtml");
   } else if (file_exists($f="top.php")) {
	include($f);
   }

   list($width,$height) = getimagesize("front.png");

if (!$b && !$t && !$matrix) { ?>
<img src="front.png" alt="Friheden til at skrive bøger"
 align=right width="<? echo $width ?>" height="<? echo $height ?>">
<?php } ?>

<h1>Friheden til at skrive bøger</h1>
 
<?php

// Funktion til at lave hyperlink
function href($url,$desc) {
  return "<a href=\"$url\">$desc</a>";
}

// Returner filstørrelse i human readable format
function fsize_text( $filename ) {
  // ISO filstørrelser, ex: 5.5 MB
  $ISO = array("","k","M","G","T","P");
  $filesize = filesize($filename);
  if (! $filesize) {
      return "000 B";  // file_exists() skulle være checket her
  } else {
    $base = floor(floor(log10($filesize))/3);
    $num3 = $filesize/pow(1024,$base);
    return substr($num3,0,(strpos($num3,".")>2?3:4))." ".$ISO[$base]."B";
  }
}

// Funktion til at formatere filnavne.
// Online versionen skal kun have bookname een gang
// "Ændringer" skal navnet med to gange, men uden version
function form_filename( $bookname, $format ) {
  global $books;
  switch ($format[online]) {
    case 1:
      // Onlinebøger, Eks: admin/bog/index.html
      return "$bookname/$format[first]/$format[last]";
      break;
    case 2:
      // Ændringer, Eks: admin/bog/admin-apprevhist.html
      return "$bookname/$format[first]/$bookname-$format[last]";
      break;
    case 3:
      // Onlinebøger, Eks: admin/todo.html
      return "$bookname/$format[last]";
      break;
    default:
      # Eks: admin/linuxbog-admin-ps-5.6.tar.gz
      #      admin      /  linuxbog-      admin     -ps-          5.6                        .tar.gz
      return $bookname."/".$format[first].$bookname.$format[form].$books[$bookname][version].$format[last];
  }
}

function visbog( $short ) {
  global $books, $packs;
  $desc = $books[$short];
  echo "<a name=\"$short\"></a><h3>$desc[title] \n";
  echo "</h3>\n<i>$desc[comment]</i><p>";

  if ($desc[dato])
    echo $desc[dato];
  if ($desc[version])
    echo " - version $desc[version]";
  if ($desc[sideantal])
    echo " - Antal sider: ".$desc[sideantal];

  echo "<p>";
  echo "<table border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bgcolor=\"#F8F8E0\">\n<tr>\n";
  echo "<th>Bøger</th>\n";
  echo "<th>Link</th>\n";
  echo "<th>Dato</th>\n";
  echo "<th>Bytes</th>\n";
  echo "</tr>\n";
  // Her kommer listen over filtyper
  reset($packs);
  while (list($type,$attr) = each($packs)) {
    echo "<tr>\n";
    $filename = form_filename($short, $attr );
    echo "<td><b>$type</b></td>\n";
    if (file_exists($filename)) {
      echo "<td>".href($filename,"<b>$filename</b>")."</td>\n";
      $date = date("Y-m-d",filemtime($filename));
      $filesize = fsize_text($filename);
    } else {
      echo "<td><i>$filename</i></td>\n";
      $date = " - ";
      $filesize = " - ";
    }
    echo "<td align=\"center\">$date</td>\n";
    if ($attr[online])
      echo "<td>&nbsp;</td>\n";
    else
      echo "<td align=\"right\">$filesize</td>\n";
    echo "</tr>\n";
  }
  echo "</table>\n";
  echo "<p><hr align=\"left\" width=\"70%\">\n";
}

function vistype($type) {
  global $books, $packs;
  $attr = $packs[$type];
  echo "<a name=\"".rawurlencode($type)."\"></a><h3>$type</h3>\n";
  echo "<table border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bgcolor=\"#E0F8F8\">\n<tr>\n";
  echo "<th>Bøger</th>\n";
  echo "<th>Link</th>\n";
  echo "<th>Dato</th>\n";
  echo "<th>Bytes</th>\n";
  echo "</tr>\n";
  reset($books);
  while (list($short,$desc) = each($books)) {
    echo "<tr>\n";
    $filename = form_filename($short, $attr );
    echo "<td><b>$short</b></td>\n";
    if (file_exists($filename)) {
      echo "<td>".href($filename,"<b>$filename</b>")."</td>\n";
      $date = date("Y-m-d",filemtime($filename));
      $filesize = fsize_text($filename);
    } else {
      echo "<td><i>$filename</i></td>\n";
      $date = " - ";
      $filesize = "00 B";
    }
    echo "<td>$date</td>\n";
    if ($attr[online])
      echo "<td>&nbsp;</td>\n";
    else
      echo "<td align=\"right\">$filesize</td>\n";
    echo "</tr>\n";
  }
  echo "</table>\n";
}

  // Bøger
  $books = array(
    // Bognavn, forkortet
    "friheden" => array(
      title => "Linux - Friheden til at vælge installation",
      comment => "Hjælp til installation",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "unix" => array(
      title => "Linux - Friheden til at lære Unix",
      comment => "Lær elementær Unix",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "wm" => array(
      title => "Linux - Friheden til at vælge grafisk brugergrænseflade",
      comment => "Lær hvilken grafisk brugergrænseflade som passer dig bedst",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "applikationer" => array(
      title => "Linux - Friheden til at vælge programmer",
      comment => "Vælg programmer til Linux",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk",
        "Hans Schou" => "chlor@sslug.dk"
      )
    ),
    "kontorbruger" => array(
      title => "Linux - Friheden til at vælge kontorprogrammer",
      comment => "Basal anvendelse af Linux kontorprogrammer",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "admin" => array(
      title => "Linux - Friheden til systemadministration",
      comment => "Administrer din egen Linux-server",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk",
        "Hans Schou" => "chlor@sslug.dk"
      )
    ),
    "program" => array(
      title => "Linux - Friheden til at programmere",
      comment => "Programmering på Linux",
      auth => array(
        "Jacob Sparre Andersen" => "sparre@sslug.dk",
        "Peter Toft" => "pto@linuxbog.dk",
        "Hans Schou" => "chlor@sslug.dk"
      )
    ),
    "c" => array(
      title => "Linux - Friheden til at programmere i C",
      comment => "Programmering i C",
      auth => array(
        "Donald Axel" => "donald_j_axel@get2net.dk"
      )
    ),
    "java" => array(
      title => "Linux - Friheden til at programmere i Java",
      comment => "Programmering i Java",
      auth => array(
        "Christian Damsgaard" => "damsgaard@image.dk"
      )
    ),
    "sikkerhed" => array(
      title => "Linux - Friheden til sikkerhed på internettet",
      comment => "Sikkerhed omkring din Linux-boks",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "web" => array(
      title => "Linux - Friheden til egen webserver",
      comment => "Web og databaser",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk",
        "Hans Schou" => "chlor@sslug.dk"
      )
    ),
    "dokumentation" => array(
      title => "Linux - Friheden til at skrive dokumentation",
      comment => "Skrive dokumentation under Linux",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "kontorbruger" => array(
      title => "Linux - Friheden til at vælge kontorprogrammer",
      comment => "Basal anvendelse af Linux-programmer",
      auth => array(
        "Peter Toft" => "pto@linuxbog.dk"
      )
    ),
    "forsker" => array(
      title => "Linux - Friheden til at studere og forske",
      comment => "En begynderbog for samfundsfagfolk og humanister",
      auth => array(
        "Janus Sandsgaard" => "janus@janus.dk"
      )
    ),
    "signatur" => array(
      title => "Linux - Friheden til at vælge digital signatur",
      comment => "Digital signatur på Linux",
      auth => array(
        "Mads Bondo Dydensborg" => "madsdyd@challenge.dk"
      )
    ),
    "itplatform" => array(
      title => "Linux - Friheden til at vælge IT-løsning",
      comment => "Valg af Linux-baseret IT-løsning",
      auth => array(
        "Michael Rasmussen" => "mir@miras.org",
        "Peter Toft" => "pto@linuxbog.dk"
     )
    ),
   "samling" => array(
     title => "Linux - Friheden til at skrive bøger",
     comment => "En pakke med alle bøgerne i",
     auth => array(
       "Peter Toft" => "pto@linuxbog.dk",
       "Henrik Christian Grove" => "grove@sslug.dk",
       "Hans Schou" => "chlor@sslug.dk"
     )
    ),
   "alle" => array(
     title => "Linux - Friheden til at skrive bøger",
     comment => "Alle bøgerne samlet til én stor bog",
     auth => array(
       "Peter Toft" => "pto@linuxbog.dk",
       "Hans Schou" => "chlor@sslug.dk"
     )
   )
  );

  $ext_files = array(
    "version" => "/version.sgml",
    "sideantal" => "/sideantal.txt",
    "dato" => "/dato.sgml"
  );

  // Sæt versionsnumre, sideantal og dato på bøgerne
  $totalsideantal = 0;
  reset($books);
  while (list($bookname) = each($books)) {
    reset($ext_files);
    while (list($ftype,$fname) = each($ext_files)) {
      if (file_exists($bookname.$fname)) {
        $num = file($bookname.$fname);
        $books[$bookname][$ftype] = trim($num[0]);
        if ($ftype == "sideantal" && $bookname != "alle")
          $totalsideantal += trim($num[0]);
      }
    }
  }


  // Bogpakker pakket på forskellige måder
  // <first><$books><last>
  $packs = array(
    // Eks: frihed/bog/index.html
    "Online" => array(
      first => "bog",
      form => "",
      last => "index.html",
      online => 1  // Hvis bognavn kun skal med een gange
    ),
    // Eks: frihed/bog/index.html
    "Ændringer" => array(
      first => "bog",
      form => "",
      last => "apprevhist.html",
      online => 2  // "Ændringer" har bognavn med to gange
    ),
    // Eks: frihed/linuxbog-friheden-html-4.0.tgz
    "HTML" => array(
      first => "linuxbog-",
      form => "-html-",
      last => ".tar.gz"
    ),
    "HTML zip" => array(
      first => "linuxbog-",
      form => "-html-",
      last => ".zip"
    ),
    "PNG billeder" => array(
      first => "linuxbog-",
      form => "-png-",
      last => ".tar.gz"
    ),
    "HTML u/billeder" => array(
      first => "linuxbog-",
      form => "-htmlub-",
      last => ".tar.gz"
    ),
    // Eks: linuxbog-frihed-pdf.zip
    "PDF" => array(
      first => "linuxbog-",
      form => "-",
      last => ".pdf"
    ),
    "PalmPilot" => array(
      first => "linuxbog-",
      form => "-palm-",
      last => ".zip"
    ),
    "eksempler" => array(
      first => "linuxbog-",
      form => "-eksempler-",
      last => ".tar.gz"
    ),
    "SGML" => array(
      first => "linuxbog-",
      form => "-sgml-",
      last => ".tar.gz"
    ),
    "SGMLzip" => array(
      first => "linuxbog-",
      form => "-sgml-",
      last => ".zip"
    ),
    "TODO" => array(
      first => ".",
      form => "",
      last => "todo.html",
      online => 3  
    )
  );

  $bgcolor = array("#FFFFFF","#E8E8E8");

  // Vis en bog med alle dens typer
  if (strlen($b) && is_array($books[$b])) {
    visbog($b);
    echo "<p>\n";
  }

  // Vis en type med alle dens bøger
  if (strlen($t) && is_array($packs[$t])) {
    vistype($t);
    echo "<p>\n";
  }

  // Vis alle bøger
  if ($all == "b") {
    echo "<h2>Bøger</h2>\n";
    // Liste over alle bøger. Alle bøger har hver sin tabel med forskellig filtyper
    reset($books);
    while (list($short,$desc) = each($books)) {
      visbog($short);
    }
  }

  // Vis alle filtyper
  if ($all == "t") {
    echo "<h2>Filtyper</h2>\n";
    // Liste over filtype. Hver filtype har sin egen tabel med alle bogtitler.
    reset($packs);
    while (list($type,$attr) = each($packs)) {
      vistype($type);
    }
  }

if ($matrix) { ?>
<hr>
<a name="matrix"></a>
<h2>Samlet bogoversigt</h2>
<table border="1" cellspacing="0" cellpadding="3">
<tr bgcolor="#F0F0FF"><th>Bøger/filtype</th>
<?php

  // Stor tabel med alle bøger og filtyper samlet.
  reset($packs);
  list($type) = current($packs);
  while (list($type) = each($packs)) {
    echo " <th>$type</th>\n";
  }
  echo "</tr>\n";
  
  $notexists = array();
  $fcount = 0;
  $c = 0;
  reset($books);
  while (list($short,$desc) = each($books)) {
    echo "<tr bgcolor=\"".$bgcolor[++$c & 1]."\">\n <td valign=\"top\">";
    echo "<b>$desc[title]</b><font size=\"-1\"><br>$desc[comment]</font></td>\n";
    reset($packs);
    while (list($type,$attr) = each($packs)) {
      $fcount++;
      echo " <td valign=\"top\"><font size=\"-1\">";
      $filename = form_filename( $short, $attr );
      $filetext = "$short $type";
      if (!file_exists($filename)) {
	$notexists[] = $filename;
        echo "<i>$filetext</i>";
        $date = " - ";
      } else {
        $filesize = fsize_text($filename);
        $date = date("Y-m-d",filemtime($filename));
        echo "ver $desc[version] ";

        //echo "<br>$date<br>$filesize";
	$linktext = "$date<br>$filesize";
        echo href($filename,$linktext);
      }
      echo "</font></td>\n";
    }
    echo "</tr>\n";
  }
?>
</table>
<p>
<?php }

if (count($notexists))
	echo "<p>Ud af $fcount filer, er der ".count($notexists)." der ikke findes online.</p>\n";

?>

<font size="-1">
[<a href="http://www.linuxbog.dk/">Seneste udgaver</a>]
[<a href="http://cvs.linuxbog.dk">Beta-upgaver</a>]
[<a href="laese-vejledning.html">Læsevejledning</a>]
[<a href="hjaelpe.html">Om at hjælpe</a>]
[<a href="http://cvs.linuxbog.dk/cvs2html/cvs_crono.html">Følg ændringer</a>]
<br>
[<a href="?matrix=1">Samlet bogoversigt</a>]
[<a href="?all=b">Alle bøger</a>]
[<a href="?all=t">Alle filtyper</a>]
[<a href="search.php">Søg</a>]
[<a href="alle/bog/stikord.html">Stikord</a>]
</font>

<h2>Vi har følgende bøger</h2>
<p>
Filtyper: 
<?php

  // Kort liste over filtyper: "Online, HTML..."
  reset($packs);
  while (list($type) = each($packs)) {
    // Nogle filtyper har mellemrum i navnet, derfor bruges rawurlencode()
    $raw = rawurlencode($type);
    echo "<a href=\"?t=$raw\">$type</a>\n";
  }

?>
<p>
<ul>
<?php

  // Pæn bullet liste over alle bog-titler med kort beskrivelse
  reset($books);
  while (list($short,$desc) = each($books)) {
    echo "<li><b>$short:</b> ";
    $raw = rawurlencode($short);
    echo href("?b=$raw","<b>$desc[title]</b>");
    echo "<br> $desc[comment]";
    if ($desc[sideantal])
      echo ", $desc[sideantal] sider.";
    echo "</li>\n";
  }
?>
</ul>

<p>
Det samlede sideantal for alle bøger er <b><?php echo $totalsideantal ?></b> sider.
</p>

<hr>
<?php
  include("sidsteudgave.incl");
?>

<hr>
<p>
Benyt vores "Et-klik-service" for at downloade og læse bøgerne,
eller køb en indbundet udgave hos følgende forretninger:
<ul>
<!-- <li><a href="http://www.pn-tryk.dk/html/linux.html">PN-tryk</a></li> -->
<li><a href="http://linuxpusher.dk/docs/linuxboeger.php">SC-Birkerød i samarbejde med www.linuxpusher.dk</a></li>
</ul>
<p>
Bøgerne er udgivet under 
<a href="licens.html">Åben dokumentlicens</a>
hvilket gør at forfatterne ikke er involveret i de trykte udgaver.
</p>


<FORM METHOD="GET" ACTION="http://www.netmind.com/cgi-bin/uncgi/url-mind">
Vil du modtage E-post om nye versioner af bogen?
<BR>Skriv din E-post adresse her
<BR><INPUT TYPE=TEXT SIZE=40 NAME="required-email">
<BR><INPUT TYPE=HIDDEN VALUE="http://www.linuxbog.dk" NAME="url">
<INPUT TYPE=SUBMIT VALUE="Indsend form"></FORM>

<p>
Bøgerne redigeres af Peter Toft, Jacob Sparre Andersen, Hans Schou,
Donald Axel og flere andre - 
&lt;<a href="mailto:linuxbog@sslug.dk">linuxbog@sslug.dk</a>&gt;.
<br>
Indholdet af bøgerne diskuteres på
&lt;<a href="mailto:sslug-bog@sslug.dk">sslug-bog@sslug.dk</a>&gt;.
</p>

<p>
Vil du følge med i hvad der sker med vores kilde-kode (SGML-filerne), 
<a href="http://cvs.linuxbog.dk/">så se her</a>.
</p>


<p>
Hvis du har noget du søger efter, så skal du nok <a
href="alle/bog/stikord.html">starte i vores samlede
indeks-register.</a>
</p>

<p>
Se også vores konkurrenters bøger ;-)
</p>

<ul>
<li>"Linux i skolen" på <a href="http://www.gnuskole.dk">www.gnuskole.dk</a></li>
<li>"Debianguiden" på <a href="http://www.debianguiden.dk/">www.debianguiden.dk/</a></li>
</ul>

<p>
Vil du hjælpe med, så læs <a href="hjaelpe.html">mere her</a>.
</p>

<a href="licens.html"><img src="licens/licens.png" alt="ÅDL"></a>


<p>
<!-- Text slut -->
<!-- Husk din email-adresse: -->
<!--<?php
	if (file_exists($DOCUMENT_ROOT."includes/bottom.phtml")) {
		include($DOCUMENT_ROOT."includes/bottom.phtml");
	} else if (file_exists($f="bot.php")) {
		include($f);
	}
?>-->
