<!-- $Id$ -->
<appendix id="nulGUIapp">
<title>Ingen grafik og hvorfor gik det så galt?</title>
<para>
Nu følger en lille tur rundt i de filer, der anvendes af X.
Det er sket før, at man ikke direkte kan få startet X-serveren, men
ofte kan man hurtigt finde ud af, hvad der gik galt.
Start med:
</para>

<screen>
<prompt>[tyge@hven ~]$ </prompt> <userinput>ls -l /usr/X11R6/bin/XF*</userinput>
-rwxr-xr-x 1 root root 2712220 Jul 29 11:30 /usr/X11R6/bin/XF86_SVGA
</screen>


<para>
Her kan du se, at X-programmet nok er installeret, og en SVGA X-server
er installeret, svarende til det aktuelle grafikkort. På
<ulink url="http://www.xfree86.org">http://www.xfree86.org</ulink> kan du se,
hvilken server der eventuelt passer til dit grafikkort.
</para>

<para>
Findes filen <command>/usr/X11R6/bin/X</command> ikke, er X-softwaren
ikke blevet installeret. I det tilfælde bør du overveje at køre
installationen forfra.
</para>


<sect1 id="XF86config-sect1">
<title>XF86Setup, xf86config, XFdrake, SaX og Xconfigurator</title>
<indexterm><primary>XF86</primary></indexterm>
<indexterm><primary>X</primary></indexterm>
<indexterm><primary>XWindow</primary></indexterm>
<para>
Du kan også vælge at køre et af programmerne <command>SaX</command>
(kun SuSE), <command>/usr/X11R6/bin/Xconfigurator</command>,
<command>/usr/X11R6/bin/XF86Setup</command> eller
<command>/usr/X11R6/bin/xf86config</command> som root for at få
genereret en X-opsætningsfil, der gemmes i
<filename>/etc/X11/XF86Config</filename> (SuSE
anvender <filename>/etc/XF86Config</filename> i den gamle XFree86 
3.X-serie). I denne fil gemmes al
information om monitor, grafikkort, mus, og hvilket tastatur der
anvendes.
</para>

<para>
Det første, du bør gøre, er at køre programmet <command>SuperProbe</command>
(som root) - programmet viser dig, hvilket grafikkort du har, og noget om den
clockchip du eventuelt har på kortet. De sidste par linjer af uddata fra
<command>SuperProbe</command> kunne se ud som:
</para>


<programlisting>
First video: Super-VGA
        Chipset: Matrox Mystique (PCI Probed)
        RAMDAC:  Matrox Mystique built-in DAC w/clock
                 (with 6-bit wide lookup tables (or in 6-bit mode))

</programlisting>

<para>
I dette tilfælde er der fundet et Matrox Mystique kort, hvor SuperVGA-driveren
til X11 skal benyttes (det er dog ikke det, der vises ud for teksten
"First video").  I øvrigt kan det være klogt at indhente data for dit
grafikkort, tastatur, mus og skærm fra producenternes hjemmesider og manualer.
</para>

<sect2 id="XFdrake">
<title>XFdrake sætter det grafiske system op til Mandrake</title>
<indexterm><primary>XFdrake</primary></indexterm>
<para>
På Mandrake er programmet <command>XFdrake</command> en nem måde at kunne
sætte X-systemet op. Programmet startes op som root, og vil automatisk søge
efter grafikkortet. Langt de fleste kort vil blive detekteret korrekt.
</para>
</sect2>

<sect2 id="xf86config-setup">
<title>xf86config</title>
<indexterm><primary>xf86config</primary></indexterm>
<indexterm><primary>Xconfigurator</primary></indexterm>
<para>
Hvis <command>xf86config</command> anvendes til at lave en
opsætningsfil, skal der først svares på, hvilken type din mus er, og
hvilken tastatur-udlægning osv.  du har - dette er reelt forklaret i
det følgende, idet <command>Xconfigurator</command> ikke er meget
anderledes. Fordelen ved <command>xf86config</command> er, at dette
program ikke automatisk søger efter hardware, og man kan således
manuelt få sat parametre for hardwaren. Ulempen er tilsvarende, at for
almindelig gangbar hardware er <command>Xconfigurator</command> bare
smartere at bruge, da automatisk søgning er nemt.
</para>
</sect2>

<sect2 id="XF86Setup-setup">
<title>XF86Setup</title>

<para>
Programmet <command>XF86Setup</command> er også godt at kende - målet er det
samme som for <command>xf86config</command> og
<command>Xconfigurator</command> - at få lavet X11-opsætningsfilen.
<command>XF86Setup</command> er grafisk. Programmet starter grafik op i lav
generisk VGA-tilstand, og man kan her nemt sætte parametre for mus, tastatur,
grafikkort og skærm.
</para>

<figure id="XF86Setup-fig" float="1">
<title>XF86Setup
</title>
<graphic fileref="XF86Setup.&magic;"  scale="50"></graphic>
</figure>
</sect2>

<sect2 id="Xconfigurator-setup">
<title>Xconfigurator</title>

<para>
Når <command>Xconfigurator</command> startes op, vises et tekst-skærmbillede
(med farver), der beskriver, at det er
<filename>XF86Config</filename>-filen, som skal rettes til.
</para>

<figure id="Xc1-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc1.&magic;"  scale="50"></graphic>
</figure>

<para>
For de fleste pc'er, der har en PCI-baseret bus, vil
programmet selv finde det korrekte grafikkort og derfra
vælge, hvilken X-server der skal bruges. Der er et par forskellige
typer - såsom S3 og SuperVGA (svga), som altså vælges automatisk.
</para>

<figure id="Xc2-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc2.&magic;"  scale="50"></graphic>
</figure>

<para>
Dernæst skal du hjælpe programmet med at vælge skærmtypen. Hent
manualen til din skærm nu. Som vist nedenfor kan du enten vælge
mellem en "custom" (egendefineret) - eller mærkevareskærm. Da mange private brugere
har en "bambus-pc", vælger vi "custom"-typen og skal så svare på et
par spørgsmål.
</para>

<figure id="Xc3-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc3.&magic;"  scale="50"></graphic>
</figure>


<para>
Du skal nu finde data for, hvor hurtig din skærm er. Find i manualen
noget om "horizontal sync" (målt i kHz) og "vertical sync" (målt i Hz),
og gå videre. Hvis du ikke har manualen, så prøv at søge på internettet 
efter din skærm og få oplysningerne derfra.
</para>

<figure id="Xc4-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc4.&magic;"  scale="50"></graphic>
</figure>

<para>
I din manual vil der stå, om din skærm kan klare 1024x768 eller måske
højere, og hvilken opdateringshastighed der understøttes.
Dette måles i Hertz (forkortet Hz). Brug pil op og ned til at vælge
mellem de mange muligheder.
</para>

<figure id="Xc5-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc5.&magic;"  scale="50"></graphic>
</figure>

<para>
Din skærm har nogle grænser for lodret synkronisering (eng. vertical
sync), som du skal vælge her. Passer din skærm ikke helt til, hvad der
kan vælges, så tag nærmeste mindre interval. Gør du ikke dette,
kan du risikere at skade din hardware.
</para>

<figure id="Xc6-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc6.&magic;"  scale="50"></graphic>
</figure>

<para>
Nu skal grafikkortet testes. Der vil blive tjekket, hvor
meget grafik-RAM kortet har. Vælg "Probe" (autodetekt).
</para>

<figure id="Xc7-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc7.&magic;"  scale="50"></graphic>
</figure>

<para>
Derefter skal du vælge, hvilke grafik-tilstande du vil kunne anvende. Vi
følger "Lad mig vælge"-muligheden.
</para>

<figure id="Xc8-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc8.&magic;"  scale="50"></graphic>
</figure>

<para> Da nedenstående eksempel er for et 1 Mb videokort, er der ikke
meget at vælge mellem. Overskriften for hver af de tre søjler viser,
hvor mange bits der skal bruges til at vise farver. Her vil 8 bits
give 256 mulige farver samtidig, 16 bits giver 65536 samtidige farver
og 24 bits mere end 16 millioner farver. Bemærk, at hvis du vælger lav
opløsning og få farver, får du en hurtigere grafikopdatering, så vælg
derfor ikke mere, end du behøver.
</para>

<figure id="Xc9-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc9.&magic;"  scale="50"></graphic>
</figure>

<para>
Nu gemmes endelig filen <filename>/etc/X11/XF86Config</filename>, og
du kan prøve at skrive <command>startx</command>.
</para>

<figure id="Xc10-fig" float="1">
<title>Xconfigurator
</title>
<graphic fileref="xc10.&magic;"  scale="50"></graphic>
</figure>
</sect2>
</sect1>

<sect1 id="XF86Configfilen">
<title>XF86Config-filen</title>

<para>
Har du installeret Red Hat 7.0, Mandrake 8.0 eller senere 
er det <filename>/etc/X11/XF86Config-4</filename> som er
interessant og du bør gå til <xref linkend="XF86Config-4-filen"/>.
</para>

<para>
For de fleste er der ikke mere opsætning for at kunne vise
grafikken. Men skulle det ske, at din mus eller dit tastatur ikke virker
helt, skal du redigere <filename>XF86Config</filename> filen med
<command>emacs</command>, <command>vi</command> eller
<command>pico</command> som vist i det følgende. <!--Disse tekst editorer
er omtalt i <xref linkend="editorer"/>.-->
</para>

<sect2 id="XFtastatur">
 <title>Tastatur</title>

 <para>
  <indexterm><primary>tastatur</primary><secondary>dansk</secondary></indexterm>
  <indexterm><primary>dansk tastatur</primary></indexterm>

  For tastaturet vil følgende linjer passe til de fleste danske
  tastaturer (en del kommentarlinjer, der begynder med
  <filename>#</filename>, er slettet):

<programlisting>
Section "Keyboard"
   Protocol        "Standard"
   AutoRepeat      500 5
   LeftAlt         Meta
   RightAlt        Meta
   ScrollLock      Compose
   RightCtl        Control
   XkbKeycodes     "xfree86"
   XkbTypes        "default"
   XkbCompat       "default"
   XkbSymbols      "us(pc101)"
   XkbGeometry     "pc"
   XkbRules        "xfree86"
   XkbModel        "pc101"
   XkbLayout       "dk"
EndSection
</programlisting>
</para>
</sect2>

<sect2 id="XFmus">
 <title>Mus</title>

 <indexterm><primary>Mus</primary></indexterm>

 <para>
  I modsætning til Windows-verdenen er det smart at købe en tre-knaps
  mus til Linux, og evt. gerne med musehjul. Man kan godt bruge
  to-knaps mus, men Linux kan anvende tre knapper på en meget smart
  måde.  
 </para>

<para>Musen kan være lidt problematisk for nogle. Får du ikke fat i den
rigtige type, kan du se det ved, at musen ofte springer rundt. Du
skal så rette i <filename>/etc/X11/XF86Config-4</filename> i afsnittet "InputDevice", 
der kan se ud som:
</para>

<programlisting>
Section "InputDevice"
    Identifier "Mouse1"
    Driver "mouse"
    Option "Protocol" "PS/2"
    Option "Device" "/dev/psaux"
#    Option "Emulate3Buttons"
#    Option "Emulate3Timeout" "50"
EndSection
</programlisting>

<para>
Vi har her med en PS/2 mus at gøre. En mus, som oftest er
af typen PS/2. Har man en mus med hjul er det normalt IMPS/2. 
Har man en to-knaps mus, må man emulere
midterknappen ved at trykke begge knapper ned på samme tid, og de to
udkommenterede linjer ovenfor skal så gøres aktive, dvs. du skal
fjerne <filename>#</filename>-tegnet.
</para>

<para>
Tjek også, at du har <filename>/dev/mouse</filename> til at pege på
den rigtige port - i dette tilfælde <filename>/dev/psaux</filename>,
som er PS/2-porten til mus.
</para>

<screen>
<prompt>[tyge@hven ~]$ </prompt> <userinput>ls -al /dev/mouse
</userinput>
lrwxrwxrwx   1 root     root            5 May 15 14:37 /dev/mouse -> psaux
</screen>

<para>
Var dette ikke tilfældet, skal du rette op på det med
</para>

<screen>
<prompt>[tyge@hven ~]$ </prompt> <userinput>rm -f /dev/mouse</userinput>
<prompt>[tyge@hven ~]$ </prompt> <userinput>ln -sf /dev/psaux /dev/mouse</userinput>
</screen>

<para>
Der er følgende lovlige protokoller, som vises ved at skrive
<filename>man XF86Config</filename>:
</para>


<sect3 id="Xpad">
<title>2 mus</title>
<indexterm><primary>mus</primary><secondary>2 stk på samme tid</secondary></indexterm>
<indexterm><primary>flere mus</primary></indexterm>
<indexterm><primary>touchpad</primary></indexterm>

<para>
I dette afsnit ser vi på hvordan man bruger 
2 mus/pegeenheder i X-Window eller både
pointerknap og touchpad og ekstern mus på en bærbar computer:
</para>

<para>

Man kan med Linux (der jo som bekendt kan ALT !) sagtens bruge to mus
(eller flere), eller to pegeenheder (eller flere). Det være sig en
tegneplade, touchpad, mus, musepen; ja et hvilket som helst HID (Human
Interface Device) man har til rådighed, som Linux på forhånd
understøtter med drivere og evt. protokoller.
</para>

<para>
Dette er specielt relevant hvis man har en bærbar computer med både en
pointerknap og en touchpad eller bare ønsker at bruge en mus af og til
uden at skulle omkonfigurere musen hele tiden. man skla blot huske på,
at man selv må finde ud af hvilke devices éns enheder sidder under, da
dette varierer individuelt fra computer til computer og fra enhed til
enhed.
</para>

<para>
For at bruge to mus under X (hér i eksemplet en PS/2 og en USB der
begge har scroolknap/musehjul) gør man følgende:
</para>

<para>

Man skal ændre i ét afsnit af
<filename>/etc/X11/XF86Config-4</filename> - nemlig afsnittet <literal>Section
"ServerLayout"</literal>, 
hvor man starter med at fortælle X, at man har mere end
bare én enhed der skal kunne peges med. Hvilken konfigurationsfil man
skal ændre i afhænger af hvilken version af X-windows man har; over
version 4.x bruger filen med 4-tallet til sidst.
</para>

<para>
Sektionen skal med mit eget eksempel med to mus se sådan hér ud:
</para>

<programlisting>
Section "ServerLayout"
        Identifier "XFree86 Configured"
        Screen      0  "Screen0" 0 0
        InputDevice    "Mouse0" "CorePointer"
        InputDevice    "Mouse1" "SendCoreEvents"
        InputDevice    "Keyboard0" "CoreKeyboard"
EndSection
</programlisting>

<para> 
Derpå skal man indsætte disse to sektioner eller ændre dem som
vist i det følgende. Den første mus hér er en Logitech PS/2 mus (med
scroll - derfor protokol IMPS/2) og derfor er Option "Emulate3Buttons"
"no" sat til no da den har tre knapper. Hvis musen kun har to knapper
sættes dette til "yes" i stedet.
</para>

<programlisting>
# Logitech Pilot Wheel Mouse
Section "InputDevice"
        Identifier      "Mouse0"
        Driver          "mouse"
        Option          "Device"                "/dev/psaux"
        Option          "Protocol"              "IMPS/2"
        Option          "Emulate3Buttons"       "no"
        Option         "ZAxisMapping"          "4 5"
EndSection
</programlisting>

<indexterm><primary>mus</primary><secondary>opløsning</secondary></indexterm>
<indexterm><primary>xset</primary><secondary>m</secondary></indexterm>

<para>
Den sidste mus her er en Razor Boomslang 2000 USB mouse (også med
scroolknap). Musen har en opløsning på 2000 DPI (MEGET følsom
mus). Derfor er Option "Resolution" sat til musens relevante DPI.
En anden - måske ligeså smart - metode til at styre accellerationen
af musen med <command>xset m 5</command>, <command>xset m 10</command>, eller
lignende, alt efter hvor hurtig man ønsker musen.
</para>
 
<programlisting>
# Razor Boomslang 2000 USB mouse
Section "InputDevice"
        Identifier      "Mouse1"
        Driver          "mouse"
        Option          "Device"                "/dev/input/mice"
        Option          "Protocol"              "IMPS/2"
        Option		"Resolution"		"2000"       
        Option          "Emulate3Buttons"       "no"
        Option         "ZAxisMapping"           "4 5"
EndSection
</programlisting>

<para>
En Razor Boomslang 2000/1000 mus eller en anden mus/pegeenhed med
flere knapper end 3, kan eventuelt bruges med alle knapper med
protokollen netmouseps/2 i stedet for IMPS/2. Dette skal så bare
ændres under <literal>Option "Protocol"</literal>. 
Da Razor Boomslang 2000 musen er så
følsom som den er, kan den anbefales enten til folk der spiller
ekstremt meget og derfor har brug for en meget høj præcision og hurtig
mus, eller til folk der har et bevægelsesmæssigt handicap (som
gigt,slidgigt og andet. Dette skyldes der ikke skal bruges særligt
mange kræfter for, at flytte musen. Endvidere er den designet så den
er éns på begge sider (=symmetrisk) og knapperne, samt designet gør at
man kan slappe helt af i hånden UDEN at man aktivere nogen af
knapperne ufrivilligt. Endvidere er den stor som næsten en halv
mursten og derfor også nem at flytte og holde på. Eventuelt kan en
glasplade anbefales sammen med musen, hvis man absolut ikke må/skal
anstrenge hånden eller håndledet.
</para>
</sect3>

</sect2>



<sect2 id="XFskaerm">
<title>Skærm</title>
<para>
Med hensyn til skærm skal du finde manualen og finde data om
"vertical sync" målt i Hz og "horizontal sync" målt i kHz.  Under
afsnittet om "Monitor" må man ikke skrive hurtigere data,
end skærmen kan klare. Det kan overbelaste skærmen! Har man
skrevet, at skærmen fint kører 90 Hz, selvom det er løgn, vil man se, at
skærmen kører med ødelagt skærmbillede lidt svarende til dårlig
TV-justering. I samme sektion som "Monitor" står en masse modelines, som
er mulige skærmfrekvenser, men det fører for vidt at forklare
formatet af disse. Et eksempel skal dog lige vises - først er der en
kommentar og dernæst parametre for den relevante mode:
</para>

<para>
<programlisting>
# 1024x768 @ 76 Hz, 62.5 kHz hsync
Modeline "1024x768"    85    1024 1032 1152 1360   768  784  787  823
</programlisting>
</para>

<para>
<emphasis>Tip:</emphasis> Kan du ikke få din skærm til at køre i 16
bitplaner (65536 farver), så skriv <command>exec X :0.0 -bpp
16</command> i filen <filename>~/.xserverrc</filename>
</para>

</sect2>
</sect1>

<sect1 id="XF86Config-4-filen">
<title>XF86Config-4 filen</title>


<para>
I det følgende er vist et eksempel på hvordan en konfigurationsfil til
XFree86 version 4 kan se ud for en Dell Latitude laptop, der kun skal
køre 1024x768 i 16 bitplaner. Det kan ses at der er mange ligheder med
tidligere (XFree86 version 3.X), men modelines er væk.
Bemærk at sektionen med "serverflags" betyder at den indbyggede
X-skærmskåner ikke anvendes.
</para>

<indexterm><primary>PC-projektor laptop</primary></indexterm>
<indexterm><primary>eksternt display</primary></indexterm>
<indexterm><primary>intern_disp</primary></indexterm>
<indexterm><primary>extern_disp</primary></indexterm>
<indexterm><primary>laptop</primary><secondary>eksternt display</secondary></indexterm>

<para>
Det kan bemærkes at for laptops kan man udkommentere de to 
linjer med "intern_disp" og "extern_disp" for at kunne
vise video på skærm samtidig med en PC-projektor er koblet på.
</para>

<programlisting>
# XFree86 4.0 configuration generated by Xconfigurator

Section "ServerLayout"
	Identifier "XFree86 Configured"
	Screen      0  "Screen0" 0 0
	InputDevice    "Mouse0" "CorePointer"
	InputDevice    "Keyboard0" "CoreKeyboard"
EndSection

# By default, Red Hat Linux 6.0 and later use xfs

Section "Files"
	FontPath "unix/:7100"
EndSection

# This loads all the modules...

Section "Module"
	Load  "GLcore"
	Load  "dbe"
	Load  "dri"
	Load  "extmod"
	Load  "glx"
	Load  "pex5"
	Load  "record"
	Load  "xie"
	Load  "v4l"
EndSection

Section "InputDevice"
	Identifier  "Keyboard0"
	Driver      "keyboard"
	Option      "XkbLayout"	"dk"
EndSection

Section "InputDevice"
	Identifier  "Mouse0"
	Driver      "mouse"
	Option      "Device" "/dev/mouse"
	Option      "Protocol" "PS/2"
	Option      "Emulate3Buttons" "on"
	Option      "ZAxisMapping" "4 5"
EndSection

Section "Monitor"
	Identifier "My Monitor"
	VendorName "Unknown"
	ModelName  "Unknown"
	HorizSync 31.5 - 48.5
	VertRefresh 50-90
EndSection

Section "Device"
	Identifier "Neomagic Corporation|NM2160 [MagicGraph "
	Driver "neomagic"
	BoardName "Unknown"
#        Option     "intern_disp"
#        Option     "extern_disp"
EndSection

Section "Serverflags"
	Option "NoPM" "yes"
EndSection

Section "Screen"
	Identifier "Screen0"
	Device "Neomagic Corporation|NM2160 [MagicGraph "
	Monitor "My Monitor"
	DefaultDepth 16
	Subsection "Display"
		Depth 16
		Modes "1024x768"
	EndSubSection
EndSection

Section "DRI"
EndSection
</programlisting>

</sect1>

<sect1 id="USB-modem">
<title>USB modem</title>
<indexterm><primary>modem</primary><secondary>USB</secondary></indexterm>
<indexterm><primary>USB</primary><secondary>modem</secondary></indexterm>
<para>
USB modem (til alm. telefonlinjer, ISDN eller kabel) bør overholde
CSC (Communication Device Class) specifikationen, og til underklassen
ACM (Abstract Control Model) - eller vil du ikke kunne få det til at virke 
med Linux
</para>

<para>
Du skal have fat i et kerne-modul "USB Modem (CDC ACM)".
Det skal kunne findes om "acm.o" under dine kerne-moduler
<filename>/lib/modules/KERNEVERSION</filename>. Med nyere
kerne 2.4-distributioner, bør den være med.
</para>

<para>
Hvis det ikke er gjort for dig, så skal du sætte devices op til dit USB-modem.
Der kan sættes 32 modemer op til samme driver, men vi tager kun de fire 
første her:
</para>

<screen>
<prompt>[root@hven root]# </prompt><userinput>mknod /dev/usb/ttyACM0 c 166 0</userinput>
<prompt>[root@hven root]# </prompt><userinput>mknod /dev/usb/ttyACM1 c 166 1</userinput>
<prompt>[root@hven root]# </prompt><userinput>mknod /dev/usb/ttyACM2 c 166 2</userinput>
<prompt>[root@hven root]# </prompt><userinput>mknod /dev/usb/ttyACM3 c 166 3</userinput>
</screen>

<para>
Dernæst bør man kunne anvende <filename>/dev/usb/ttyACM0</filename>
som det første modem. Anvend <command>ln -sf /dev/usb/ttyACM0 /dev/modem</command> for at <filename>/dev/modem</filename> peger på det første USB-modem.
</para>
</sect1>

</appendix>


